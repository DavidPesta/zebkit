<!DOCTYPE html>
<html lang="en-us">

  <head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <meta name="viewport"
       content="user-scalable=no,width=device-width,initial-scale=1,maximum-scale=1">
    <meta name="msapplication-tap-highlight" content="no">


    <title>
        
          Event handling &middot; Zebkit - UI platform
        
    </title>

  <!-- CSS -->


    <link rel="stylesheet" href="/website/light/public/css/poole-light.css">
    <link rel="stylesheet" href="/website/light/public/css/syntax-light.css">
    <link rel="stylesheet" href="/website/light/public/css/main-light.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=EB+Garamond">
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/website/light/public/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/website/light/public/favicon.ico">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

    <script type="text/javascript" src="/build/zebkit.js?25082018">  </script>

    <script type="text/javascript">
        zebkit.ui.config("theme", "light");
    </script>
</head>



  <body>

    <div class="sidebar" style="padding: 0px;   border-right: 1px solid orange" >
    <div class="container sidebar-sticky" style="padding: 0px; margin: 0px;">
        <table style="height:100%;border-width: 0px; border-color: #151515;">
            <tr>
                <td colspan="2" align="center" style="border-width: 0px; margin: 0px; padding: 0px;">
                
                    <a href="../dark/docs.ui.event.html">
                        <img style="margin: 0px; padding: 0px;" src="/website/light/public/images/zebkit.logo.png" width="60%">
                    </a>
                

                </td>
            </tr>
            <tr>
                <td colspan="2" style="border-width: 0px;">
                    <p style="margin:0px; font-style: italic;"><b style='color:orange; font-size:1.5rem;'>Zebkit</b> is HTML5 Canvas based UI platform developed with unique EasyOOP JavaScript concept and rich extendible components set</p>
                </td>
            </tr>

            <tr style="height:100%;" valign="top" align="right">
                <td colspan="2" style="border-width: 0px;">
                    
                    
                        
                        
                        
                    
                        
                        

                            
                            


                            <a class="sidebar-nav-item "
                               href="/website/light/about.html">
                                Zebkit ?
                            </a>


                        
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                        


                        
                        
                    
                        
                        

                            
                            


                            <a class="sidebar-nav-item "
                               href="/website/light/api.html">
                                API Doc
                            </a>


                        


                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        

                            
                            


                            <a class="sidebar-nav-item active"
                               href="/website/light/docs.html">
                                Documentation
                            </a>


                        
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                                
                                    <a class="sidebar-nav-item active"
                                       href="/website/light/docs.ui.event.html">
                                        <table cellpadding="0" cellspacing="0" style="padding: 0px;width:auto;margin:0px;">
                                       <!--
                                            <tr>
                                                <td colspan="2" style="padding: 0px;" align="right">
                                                    ┃
                                                </td>
                                            </tr>
                                        -->
                                            <tr>
                                                <td style="padding: 0px;">
                                                     Event handling
                                                </td>
                                                <td style="padding: 0px;">
                                                   &nbsp;◀┛&nbsp;&nbsp;
                                                </td>
                                            </tr>
                                        </table>
                                    </a>
                                
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                                
                            
                        
                            
                        
                            
                        
                        


                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        
                        
                    
                        
                        

                            
                            


                            <a class="sidebar-nav-item "
                               href="/website/light/getstarted.html">
                                Get started
                            </a>


                        


                        
                        
                    
                </td>
            </tr>

            <tr style="height:90px;">
                <td colspan="2"  style="border-width: 0px;padding: 0px;"></td>
            </tr>

            <tr>
                <td align="right" colspan="2" style="border-width: 0px; border-top: 1px solid orange;">
                    <small><a href="mailto:ask@zebkit.org">Andrei Vishneuski (c), 2018</a></small>
                </td>
            </tr>

            <tr>
                <td colspan="2" valign="top" align="right" style="border-width: 0px;padding: 0px;">
                    <table style="width:240px;border-width: 0px; padding: 0px;" cellpadding="0" cellspacing="0">
                        <tr style="padding: 0px;" border="1">
                            <td style="width:60px;border-width: 0px;" align="right">
                                <a href="https://github.com/barmalei/zebkit" title="Download">
                                    <img alt="Download" title="Download" src="/website/light/public/images/github3.png" width="40px" height="40px">
                                </a>
                            </td>
                            <td style="width:60px; border-width: 0px;" align="right">
                                <a href="https://twitter.com/zebkit">
                                    <img src="/website/light/public/images/twitter.png" width="40px" height="40px">
                                </a>
                            </td>
                            <td style="width:60px; border-width: 0px;" align="right">
                                <a href="https://nl.linkedin.com/in/andrei-vishneuski-34b52514">
                                    <img src="/website/light/public/images/linkedin.png" width="40px" height="40px">
                                </a>
                            </td>

                            <td style="width: 70px; border-width: 0px; " valign="center" align="right">
                                <a href="../build/zebkit.runtime.zip">
                                    <img src="/website/light/public/images/download-light.png" width="40px" height="40px">
                                </a>
                            </td>

                        </tr>
                    </table>
                </td>

            </tr>

        </table>

    <nav class="sidebar-nav">

<!--
      <a class="sidebar-nav-item" href="/website/light/">Home</a>
 -->

    </nav>

  </div>
</div>

    <div class="content container">
      <div class="page">

    

    <h3 id="component-specific-event-handling">Component specific event handling</h3>

<p>Components (visual and not-visual) often fire specific to its business events. For instance text model fires text updated event, button UI component fires fired event every time the button has been pressed, list component fires selected event when a new item in the list has been selected and so on. To handle such sort of events a listener or listeners registration pattern have to be applied. A listener can be registered or removed with calling <strong>“on()/off()”</strong> methods that are part of zebkit component API:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">comp</span><span class="p">.</span><span class="nx">on</span><span class="p">([</span><span class="nx">eventName</span><span class="p">,][</span><span class="nx">path</span><span class="p">,],</span> <span class="nx">callback</span><span class="p">);</span>
</code></pre>
</div>

<ul>
  <li>
    <p><strong>path</strong> is an optional parameter to lookup component or components the given event handler have to be registered. Path is X-Path like expression. For instance: <code class="highlighter-rouge">"//*"</code> detects all child components, <code class="highlighter-rouge">"//zebkit.ui.Label"</code> will match all child labels components.</p>
  </li>
  <li>
    <p><strong>eventName</strong> is an optional parameter to say which event exactly has to be caught. For instance: <code class="highlighter-rouge">"matrixModel.on('matrixResized', ...);"</code>. If the parameter has not been specified all available events will be caught.</p>
  </li>
  <li>
    <p><strong>callback</strong> is an event or events handler function.</p>
  </li>
</ul>

<p>To stop handling event or events use the following pattern:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">comp</span><span class="p">.</span><span class="nx">off</span><span class="p">([</span><span class="nx">eventName</span><span class="p">,][</span><span class="nx">path</span><span class="p">]);</span>
</code></pre>
</div>

<p>The parameter meaning is the same to “on(…)” method. If there is no parameters have been specified, all events handlers for the given component will be detached.</p>

<p>To develop a custom component that fires an event or events can be simplified with implementing special <strong>“zebkit.EventProducer”</strong> interface to add  “on()/off()/fire()” methods implementations. Additionally listeners container class has to be declared in <strong>“_“</strong> class static variable:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// implement  "zebkit.EventProducer" to add event listening and </span>
<span class="c1">// firing API in the class </span>
<span class="kd">var</span> <span class="nx">MyClassThatFiresEvents</span> <span class="o">=</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">Class</span><span class="p">(</span><span class="nx">zebkit</span><span class="p">.</span><span class="nx">EventProducer</span><span class="p">,</span> <span class="p">[</span>
    <span class="kd">function</span> <span class="nx">$clazz</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// define listeners container that keeps two types of events </span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_</span> <span class="o">=</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ListenersClass</span><span class="p">(</span><span class="s2">"propertyAChanged"</span><span class="p">,</span> 
                                       <span class="s2">"propertyBChanged"</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">setA</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
        <span class="c1">// fire appropriate event with API </span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s2">"propertyAChanged"</span><span class="p">,</span> <span class="p">[</span> <span class="k">this</span><span class="p">,</span> <span class="nx">v</span> <span class="p">]);</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">setB</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>
        <span class="c1">// fire appropriate event with API </span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s2">"propertyBChanged"</span><span class="p">,</span> <span class="p">[</span> <span class="k">this</span><span class="p">,</span> <span class="nx">v</span> <span class="p">]);</span>
    <span class="p">}</span> 
<span class="p">]);</span>

<span class="p">...</span>

<span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClassThatFiresEvents</span><span class="p">();</span>
<span class="nx">m</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"propertyAChanged"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// handle events </span>
    <span class="p">...</span>
<span class="p">});</span>

<span class="c1">// this triggers "propertyAChanged" event will be fired</span>
<span class="nx">m</span><span class="p">.</span><span class="nx">setA</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</code></pre>
</div>

<h3 id="ui-events-handling">UI events handling</h3>

<p>UI components generate number of UI specific events:</p>

<ul>
  <li><strong>Key events</strong> : key pressed, released and typed</li>
  <li><strong>Pointer events</strong> : pointer pressed, released, clicked, moved, dragged and so on. Zebkit pointer events are unified, what means the same event type is used for various input devices: mouse, touch screen, pen.</li>
  <li><strong>Focus events</strong> UI components can catch focus gained and lost events.</li>
  <li><strong>UI Component events</strong> UI components can update its metrics (size, location) and manage the child components set (add, remove, set). This triggers component events: component added, component resized and so on.</li>
</ul>

<p><strong>Pay attention the events types are handled following &lt;h4&gt;overriding pattern&lt;/h4&gt; instead of registering listeners via __“on(…)/off(…)”</strong> methods call. It is done to save resources, speeds up events handling and minimize possible memory leaks that are probable when developers have to track listeners list.</p>

<p>Overriding pattern means that events catching have to be done by overriding desired UI events handler methods. For instance, if to handle pointer released event do it as follow:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="p">...</span>
<span class="kd">var</span> <span class="nx">comp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">Panel</span><span class="p">();</span>
<span class="p">...</span>
<span class="nx">comp</span><span class="p">.</span><span class="nx">pointerReleased</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// here you will get pointer released event </span>
    <span class="p">...</span>
<span class="p">};</span>
</code></pre>
</div>

<p>or the same with anonymous class paradigm:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="p">...</span>
<span class="kd">var</span> <span class="nx">comp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">Panel</span><span class="p">([</span>
    <span class="kd">function</span> <span class="nx">pointerReleased</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// here you will get pointer released event </span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">]);</span>
</code></pre>
</div>

<p>Pay attention that zebkit UI components can have own implementations of appropriate UI events handlers. In this case don’t forget to call super implementation:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="p">...</span>
<span class="kd">var</span> <span class="nx">comp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">Button</span><span class="p">(</span><span class="s2">"Button"</span><span class="p">,</span> <span class="p">[</span>
    <span class="kd">function</span> <span class="nx">pointerReleased</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// here you will get pointer released event </span>
        <span class="p">...</span>
        <span class="c1">// call super implementation of the UI event handler</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$super</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">]);</span>
</code></pre>
</div>

<p><strong>List of available UI events:</strong></p>

<table class="info">
<tr><th>UI events names</th><th>Description</th></tr>

<tr><td valign="top">
      <p><strong>Pointer events:</strong><br />
pointerMoved, pointerPressed,<br />
pointerReleased, pointerClicked,<br /> 
pointerDragStarted, pointerDragged,<br />
pointerDragEnded, pointerEntered,<br /> 
pointerExited</p>
    </td><td>
      <p>Pointer events that are fired with mouse, touch screen, pen devices. Pointer events handlers get __“zebkit.ui.event.PointerEvent” class instance as its argument. The class has the following fields:</p>

      <ul>
        <li><strong>source</strong>. Source UI component that has fired the event</li>
        <li><strong>id</strong>. Name of the event (“ponterPressed”, “pointerEntered”, etc)</li>
        <li><strong>ponterType</strong>. A type of device that has fired the event: “mouse”, “touch”, etc.</li>
        <li><strong>identifier</strong>. An identifier of pointer event. For instance multiple touch events have unique identifiers. Events are fired with mouse left and right buttons will have “lmouse” and “rmouse” identifiers correspondingly.</li>
        <li><strong>touchCounter</strong>. Amount of touches. In case of mouse if you press both left and right button then “touchCounter” field will be set to 2.</li>
        <li><strong>altKey, shiftKey, ctrlKey, metaKey</strong>. Meta key states boolean flags.</li>
        <li><strong>absX, absY</strong>. Absolute location of pointer event relatively to HTML Canvas where the UI component is hosted.</li>
        <li><strong>x, y</strong>. Location relatively to a source UI component.</li>
      </ul>

    </td></tr>

<tr><td valign="top">
      <p><strong>Key events:</strong><br />
keyPressed, keyTyped,<br />
keyReleased</p>
    </td><td>
      <p>Keyboard events. Key event handler methods get <strong>“zebkit.ui.event.KeyEvent”</strong> class instance as its argument. The class has the following fields:</p>

      <ul>
        <li><strong>source</strong>. Source UI component that has fired the event</li>
        <li><strong>id</strong>. Name of the event (“keyTyped”, “keyPressed”, etc)</li>
        <li><strong>key</strong>. A character(s) that has been typed.</li>
        <li><strong>code</strong>. A unique key code like “KeyK”, “F1”, “Escape”, etc</li>
        <li><strong>altKey, shiftKey, ctrlKey, metaKey</strong>. Meta key states boolean flags.</li>
        <li><strong>device</strong>. Name of devices that fired the given event: “keyboard”, “virtualKeyboard”.</li>
        <li><strong>repeat</strong>. Number of repeated occurrences.</li>
      </ul>

    </td></tr>

<tr><td valign="top">
      <p><strong>Focus events:</strong><br />
focusGained, focusLost</p>
    </td><td>
      <p>Focus events. Focus event handler methods get <strong>“zebkit.ui.event.FocusEvent”</strong> class instance as its argument. The class has the following fields:</p>

      <ul>
        <li><strong>source</strong>. Source UI component that has fired the event</li>
        <li><strong>id</strong>. Name of the event (“focusLost”, “focusGained”)</li>
        <li><strong>related</strong>. A related UI component. In a case “focusGained” event the field keeps an UI component that has lost focus. In a case of “focusLost” event the field keeps an UI component that is going to gain focus.</li>
      </ul>

    </td></tr>

<tr><td valign="top">
      <p><strong>UI component events:</strong><br />
compResized, compMoved,<br /> 
compEnabled, compShown,<br />
compAdded, compRemoved</p>
    </td><td>
      <p>UI component events. Component event handler methods get <strong>“zebkit.ui.event.CompEvent”</strong> class instance as its argument. The class has the following fields:</p>

      <ul>
        <li><strong>source</strong>. Source UI component that has fired the event</li>
        <li><strong>id</strong>. Name of the event (“compResized”, “compMoved”, etc)</li>
        <li><strong>kid</strong>. A kid that has been removed or added.</li>
        <li><strong>index</strong>. An index of a kid that has been removed or added to the source component.</li>
        <li><strong>constraints</strong>. A layout constraints the kid has been added to the source component.</li>
        <li><strong>prevX, prevY</strong>. A previous location the component has had before it has been moved.</li>
        <li><strong>prevWidth, prevHeight</strong>. A previous size the component has had before it has been re-sized.</li>
      </ul>

    </td></tr>
</table>

<h2 id="handling-child-ui-events">Handling child UI events</h2>

<p>To catch UI events from child components (on all level of UI hierarchy) follow the same overriding appropriate that have been shown before, but in this case add “child” prefix to a name of required handler method name.</p>

<p>For instance, imagine a panel contains number of labels components as its children. To handle pointer pressed events that have occurred over the labels “pointerPressed” method handler can be overriding. It has to be done for every label component. The solution is not handy and generic. Instead add child UI events handler on the level of parent panel component:</p>

<table class="zsample" style="margin:0px;" cellpadding="0" cellspacing="0">
    <tr style="padding: 0px;margin: 0px;">
        <td align="center" valign="center" style="padding: 0px; margin: 0px;">
            <canvas id="childrenEvents" style="padding: 0px; margin: 0px;"></canvas>
        </td>
        <td valign="top" rowspan="2" style="left-padding: 8px; margin: 0px;">
            
        </td>
    </tr>
    <tr>
        <td align="center" style="padding:0px; margin:0px;">
            <span style="color:red;font-size:14px;">Child UI events handling </span>
        </td>
    </tr>
</table>

<script type="text/javascript">
zebkit.require("ui", function(ui) {
    var root = new ui.zCanvas("childrenEvents", 400, 300).root;
    root.setListLayout(8);
    root.setPadding(8);
    root.setBorder("plain");
    for (var i = 0; i < 5; i++) {
        root.add(new ui.Label("Press on " + i + "-th label\n" + 
                              "to change its background")
            .setPadding(4))
            .setBorder("plain");
    }

    root.childPointerPressed = function(e) {
        e.source.setBackground(e.source.bg !=null ? null : "#44AAFF"); 
    };
});  
</script>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">zebkit</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">"ui"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ui</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">zCanvas</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">).</span><span class="nx">root</span><span class="p">;</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">setListLayout</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">setPadding</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">setBorder</span><span class="p">(</span><span class="s2">"plain"</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">root</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Label</span><span class="p">(</span><span class="s2">"Press on "</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s2">"-th label\n"</span> <span class="o">+</span> 
                              <span class="s2">"to change its background"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">setPadding</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
            <span class="p">.</span><span class="nx">setBorder</span><span class="p">(</span><span class="s2">"plain"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// catch child labels pointer pressed event to update </span>
    <span class="c1">// the labels background</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">childPointerPressed</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">setBackground</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">bg</span> <span class="o">!=</span> <span class="kc">null</span> <span class="p">?</span><span class="kc">null</span><span class="p">:</span><span class="s2">"#44AAFF"</span><span class="p">);</span> 
    <span class="p">};</span>
<span class="p">});</span>  
</code></pre>
</div>

<h2 id="composite-components">Composite components</h2>

<p>Zebkit UI is organized as a hierarchy of UI components where every UI component can be a container for other UI components. UI hierarchy is a good developing approach to implement compound UI components where developers can assemble UI components from another UI components. For example  “zebkit.ui.Button” component can use any other UI component as its content: images, series of images, combinations of labels and images, etc.</p>

<p>Handling of UI input events (pointer, key, focus) in compound component can be not a trivial thing since the input events are captured with child components.  In the case of “zebkit.ui.Button” every time a pointer pressed over its content component (for instance label) the event is sent only to the content component, button itself doesn’t get it. Possible solution is implementing child component UI events handler(s) as it has been described earlier. More graceful solution is follow <strong>composite UI component</strong> approach.</p>

<p>Composite is an UI component that makes its child components “event transparent”. Event transparency means the child components don’t get any input (pointer, keyboard, etc) events. It looks like the child components transparent for these events. The input events are sent directly to a parent component as if its child component not exist.</p>

<p>To make children of a container events transparent set <strong>“catchInput”</strong> property in the container to <code class="highlighter-rouge">true</code> value:</p>

<table class="zsample" style="margin:0px;" cellpadding="0" cellspacing="0">
    <tr style="padding: 0px;margin: 0px;">
        <td align="center" valign="center" style="padding: 0px; margin: 0px;">
            <canvas id="compositeComp1" style="padding: 0px; margin: 0px;"></canvas>
        </td>
        <td valign="top" rowspan="2" style="left-padding: 8px; margin: 0px;">
            
        </td>
    </tr>
    <tr>
        <td align="center" style="padding:0px; margin:0px;">
            <span style="color:red;font-size:14px;">Child UI events handling </span>
        </td>
    </tr>
</table>

<script type="text/javascript">
zebkit.require("ui", "layout", function(ui, layout) {
    var root = new ui.zCanvas("compositeComp1", 400, 250).root;
    root.properties({
        padding: 8,
        border: "plain",
        layout: new layout.ListLayout(16),
        kids  : [
          new zebkit.ui.Button("Event transparent button"),
          new zebkit.ui.Checkbox("Event transparent checkbox"),
          new zebkit.ui.TextField("Event transparent field")
        ]
    });
    root.catchInput = true;
});  
</script>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">zebkit</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">"ui"</span><span class="p">,</span> <span class="s2">"layout"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ui</span><span class="p">,</span> <span class="nx">layout</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">zCanvas</span><span class="p">(</span><span class="s2">"compositeComp1"</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">250</span><span class="p">).</span><span class="nx">root</span><span class="p">;</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">properties</span><span class="p">({</span>
        <span class="na">padding</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="na">border</span><span class="p">:</span> <span class="s2">"plain"</span><span class="p">,</span>
        <span class="na">layout</span><span class="p">:</span> <span class="k">new</span> <span class="nx">layout</span><span class="p">.</span><span class="nx">ListLayout</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
        <span class="na">kids</span>  <span class="p">:</span> <span class="p">[</span>
          <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">Button</span><span class="p">(</span><span class="s2">"Event transparent button"</span><span class="p">),</span>
          <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">Checkbox</span><span class="p">(</span><span class="s2">"Event transparent checkbox"</span><span class="p">),</span>
          <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">TextField</span><span class="p">(</span><span class="s2">"Event transparent field"</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">});</span>
    <span class="c1">// Make child components of "root" component </span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">catchInput</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">});</span>  
</code></pre>
</div>

<p>More flexible way to add event transparency is defining <strong>“catchInput(kid)”</strong> method (instead of treating it as a field) that gets a kid component as input parameter. Then the method has to decide whether the given child component has to be make event transparent or not:</p>

<table class="zsample" style="margin:0px;" cellpadding="0" cellspacing="0">
    <tr style="padding: 0px;margin: 0px;">
        <td align="center" valign="center" style="padding: 0px; margin: 0px;">
            <canvas id="compositeComp2" style="padding: 0px; margin: 0px;"></canvas>
        </td>
        <td valign="top" rowspan="2" style="left-padding: 8px; margin: 0px;">
            
        </td>
    </tr>
    <tr>
        <td align="center" style="padding:0px; margin:0px;">
            <span style="color:red;font-size:14px;">Children UI events handling </span>
        </td>
    </tr>
</table>

<script type="text/javascript">
zebkit.require("ui", "layout", function(ui, layout) {
    var root = new ui.zCanvas("compositeComp2", 400, 300).root;
    root.properties({
        padding: 8,
        border: "plain",
        layout: new layout.ListLayout(16),
        kids  : [
        new zebkit.ui.Button("Event transparent button"),
        new zebkit.ui.Checkbox("Normal check box"),
        new zebkit.ui.TextField("Normal field")
        ]
    });
    root.catchInput = function(kid) {
        return kid === root.kids[0]; 
    };
});  
</script>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">zebkit</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">"ui"</span><span class="p">,</span> <span class="s2">"layout"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ui</span><span class="p">,</span> <span class="nx">layout</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">zCanvas</span><span class="p">(</span><span class="s2">"compositeComp2"</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">).</span><span class="nx">root</span><span class="p">;</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">properties</span><span class="p">({</span>
        <span class="na">padding</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="na">border</span><span class="p">:</span> <span class="s2">"plain"</span><span class="p">,</span>
        <span class="na">layout</span><span class="p">:</span> <span class="k">new</span> <span class="nx">layout</span><span class="p">.</span><span class="nx">ListLayout</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
        <span class="na">kids</span>  <span class="p">:</span> <span class="p">[</span>
          <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">Button</span><span class="p">(</span><span class="s2">"Event transparent button"</span><span class="p">),</span>
          <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">Checkbox</span><span class="p">(</span><span class="s2">"Normal check box"</span><span class="p">),</span>
          <span class="k">new</span> <span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">TextField</span><span class="p">(</span><span class="s2">"Normal field"</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">});</span>

    <span class="c1">// Make first button of "root" component events transparent. </span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">catchInput</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">kid</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">kid</span> <span class="o">===</span> <span class="nx">root</span><span class="p">.</span><span class="nx">kids</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> 
    <span class="p">};</span>
<span class="p">});</span>  
</code></pre>
</div>

<h2 id="global-event-handling">Global event handling</h2>

<p>Zebkit <strong>UI events</strong> handling and distribution is managed with a special singleton class <strong>“zebkit.ui.event.EventManager”</strong> class. The manager gets all UI events and then decides how its have to be delivered to destination UI components.</p>

<p>The manager is accessible via <strong>“zebkit.ui.events”</strong> variable and provides possibility to register global events listeners. Global means the handlers  are getting all UI event or events that have happened. To register and unregister global UI events handlers follow the standard pattern:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// listen all pointer pressed events for all actiev UI components</span>
<span class="nx">zebkit</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"pointerPressed"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
<span class="p">});</span>
</code></pre>
</div>

<p>For example let’s listening “pointerPressed” event for all UI components to show information window with the source UI components metrics (size and location):</p>

<table class="zsample" style="margin:0px;" cellpadding="0" cellspacing="0">
    <tr style="padding: 0px;margin: 0px;">
        <td align="center" valign="center" style="padding: 0px; margin: 0px;">
            <canvas id="globalEvents" style="padding: 0px; margin: 0px;"></canvas>
        </td>
        <td valign="top" rowspan="2" style="left-padding: 8px; margin: 0px;">
            
        </td>
    </tr>
    <tr>
        <td align="center" style="padding:0px; margin:0px;">
            <span style="color:red;font-size:14px;">Children UI events handling </span>
        </td>
    </tr>
</table>

<script type="text/javascript">
zebkit.require("ui", function(ui) {
    var root = new ui.zCanvas("globalEvents", 400, 300).root;
    root.setRasterLayout(true);
    root.setPadding(8);
    root.setBorder("plain");

    root.add(new ui.Button("Test Button").setLocation(90,90));
    root.add(new ui.Checkbox("Test\nCheck box").setLocation(240,170));
    root.add(new ui.TextField("Test text field").setLocation(50,220));

    var info = new ui.Tooltip("");
    ui.events.on("pointerPressed", function(e) {
        if (info.parent !== null) {
            info.removeMe();
        }
        if (root !== e.source) {
            // show info about an UI component the pointer pressed
            // event has occurred  
            info.setValue("x = " + e.source.x+",y = "+e.source.y+
                          "\nw = "+e.source.width+",h = "+e.source.height);
            info.toPreferredSize();
            info.setLocation(e.absX + 5, e.absY - info.height);
            ui.showWindow(root, info);
            info.removeMe(1500);
        }
    });
});  
</script>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">zebkit</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">"ui"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ui</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">zCanvas</span><span class="p">(</span><span class="s2">"globalEvents"</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">).</span><span class="nx">root</span><span class="p">;</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">setRasterLayout</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">setPadding</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">setBorder</span><span class="p">(</span><span class="s2">"plain"</span><span class="p">);</span>
    <span class="c1">// add number of components</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Button</span><span class="p">(</span><span class="s2">"Test Button"</span><span class="p">).</span><span class="nx">setLocation</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">));</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Checkbox</span><span class="p">(</span><span class="s2">"Test\nCheck box"</span><span class="p">).</span><span class="nx">setLocation</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span><span class="mi">170</span><span class="p">));</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">TextField</span><span class="p">(</span><span class="s2">"Test text field"</span><span class="p">).</span><span class="nx">setLocation</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">220</span><span class="p">));</span>

    <span class="kd">var</span> <span class="nx">info</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Tooltip</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span>

    <span class="c1">// register global pointer pressed handler</span>
    <span class="nx">ui</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"pointerPressed"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">parent</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">info</span><span class="p">.</span><span class="nx">removeMe</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">root</span> <span class="o">!==</span> <span class="nx">e</span><span class="p">.</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// show info about an UI component the pointer pressed</span>
            <span class="c1">// event has occurred  </span>
            <span class="nx">info</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="s2">"x = "</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">x</span><span class="o">+</span><span class="s2">",y = "</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">y</span><span class="o">+</span>
                  <span class="s2">"\nw = "</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">width</span><span class="o">+</span><span class="s2">",h = "</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
            <span class="nx">info</span><span class="p">.</span><span class="nx">toPreferredSize</span><span class="p">();</span>
            <span class="nx">info</span><span class="p">.</span><span class="nx">setLocation</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">absX</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">absY</span> <span class="o">-</span> <span class="nx">info</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
            <span class="nx">ui</span><span class="p">.</span><span class="nx">showWindow</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">info</span><span class="p">);</span>
            <span class="nx">info</span><span class="p">.</span><span class="nx">removeMe</span><span class="p">(</span><span class="mi">1500</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">});</span>  
</code></pre>
</div>


</div>

    </div>


  </body>
</html>
